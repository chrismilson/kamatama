(this["webpackJsonpkamatama-jisho"]=this["webpackJsonpkamatama-jisho"]||[]).push([[0],{40:function(e,t,n){},41:function(e,t,n){},48:function(e,t,n){},49:function(e,t,n){},50:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(0),c=n(28),s=n.n(c),i=(n(40),n(12)),o=n(3),u=n(23);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function l(e){if("serviceWorker"in navigator){if(new URL("/kamatama",window.location.href).origin!==window.location.origin)return;new Promise((function(e){window.addEventListener("load",(function(){e()}))})).then((function(){alert("install")}))}}function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function h(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var b=a.createElement("g",null,a.createElement("circle",{id:"White",cx:512,cy:512,r:507,fill:"#ffffff",stroke:"#cccccc",strokeWidth:10}),a.createElement("circle",{id:"Yolk",cx:512,cy:512,r:200,fill:"#ffb43b"}));function d(e,t){var n=e.title,r=e.titleId,c=h(e,["title","titleId"]);return a.createElement("svg",f({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",ref:t,"aria-labelledby":r},c),n?a.createElement("title",{id:r},n):null,b)}var j=a.forwardRef(d),p=(n.p,n(41),function(){var e=Object(a.useState)(!1),t=Object(u.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)(null),i=Object(u.a)(s,2),f=i[0],h=i[1],b=Object(o.f)();Object(a.useEffect)((function(){"serviceWorker"in navigator&&c(!0)}),[]),Object(a.useEffect)((function(){var e=function(e){e.preventDefault(),h(e)};return window.addEventListener("beforeinstallprompt",e),function(){window.removeEventListener("beforeinstallprompt",e)}}),[]);var d=Object(a.useCallback)((function(){l(),f&&!window.matchMedia("(didsplay-mode: standalone)").matches&&f.prompt().catch(console.error)}),[f,b]);return Object(r.jsxs)("div",{className:"Landing",children:[Object(r.jsxs)("div",{className:"content",children:[Object(r.jsx)("h1",{children:"\u3053\u3093\u306b\u3061\u306f!"}),Object(r.jsx)("p",{children:"This is Kamatama Jisho, a Japanese-English phrase book powered by the web!"}),n?Object(r.jsx)("p",{children:"To install Kamatama Jisho, just press the big egg down below."}):Object(r.jsxs)("p",{children:["Uh oh! The device you are using is not capable of installing"," ",Object(r.jsx)("a",{href:"https://en.wikipedia.org/wiki/Progressive_web_application",children:"PWAs"}),". Perhaps try a different device, or a different browser!"]})]}),n&&Object(r.jsx)("button",{className:"icon",onClick:d,children:Object(r.jsx)(j,{})})]})}),m=n(51),v=n(2),O=n.n(v),x=n(5),w=n(30),y=n(31),g=n(9),k=n(33);n(21),n(22),n(34);n(32);var q=function(){var e=Object(x.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)("kamatama",1,{upgrade:function(){var e=Object(x.a)(O.a.mark((function e(t,n,r){var a,c,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Upgrading database to version ".concat(r,".")),a=t.createObjectStore("allKanji",{keyPath:"literal"}),c=t.createObjectStore("allPhrases",{keyPath:"sequenceNumber"}),(s=t.createObjectStore("queryStore",{keyPath:"sequenceNumber"})).createIndex("queryStore","values",{multiEntry:!0}),e.next=7,Promise.all([a,c,s].map((function(e){return e.transaction.done}))).catch(console.error);case 7:console.log("Database upgraded to version ".concat(r));case 8:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()});case 2:return t=e.sent,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=new(function(){function e(){Object(w.a)(this,e),this.query=void 0,this.loadingResults=void 0,this.results=void 0,this.request=void 0,this.dbPromise=void 0,Object(g.c)(this),this.query="",this.loadingResults=!1,this.results=[],this.request=0,this.dbPromise=q()}return Object(y.a)(e,[{key:"setQuery",value:function(e){this.query=e instanceof Function?e(this.query):e,this.fetchResults()}},{key:"fetchResults",value:function(){var e=Object(x.a)(O.a.mark((function e(){var t,n,r,a,c,s=this;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==this.query){e.next=3;break}return Object(g.d)((function(){s.results=[]})),e.abrupt("return");case 3:return t=++this.request,e.next=6,this.fetchSequenceNumbers();case 6:return n=e.sent,e.next=9,this.dbPromise;case 9:return r=e.sent,a=r.transaction("allPhrases"),c=[],e.next=14,Promise.all(Array.from(n).map(function(){var e=Object(x.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.store.get(t);case 2:n=e.sent,c.push(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 14:t===this.request&&Object(g.d)((function(){s.results=c}));case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchSequenceNumbers",value:function(){var e=Object(x.a)(O.a.mark((function e(){var t,n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dbPromise;case 2:return t=e.sent,n=t.transaction("queryStore"),r=new Set,e.next=7,n.store.index("queryStore").getAll(IDBKeyRange.bound(this.query,this.query+"\uffff"),50).then((function(e){e.forEach((function(e){r.add(e.sequenceNumber)}))}));case 7:return e.next=9,n.done;case 9:return e.abrupt("return",r);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}()),S=n(14),E=n(24),N=(n(48),function(e){var t=e.reading,n=e.kanji,a=e.sense;return Object(r.jsxs)("li",{className:"ResultListItem",children:[Object(r.jsx)("div",{className:"forms",children:[].concat(Object(E.a)(n),Object(E.a)(t)).sort((function(e,t){return e.priority.length-t.priority.length})).map((function(e){return e.value})).join("\u3001")}),Object(r.jsx)("div",{className:"meanings",children:a.flatMap((function(e){return e.glossary})).map((function(e){return e.value})).join(", ")})]})}),R=Object(m.a)((function(){var e=P.results;return Object(r.jsx)("ul",{className:"ResultList",children:e.map((function(e){return Object(r.jsx)(N,Object(S.a)({},e),e.sequenceNumber)}))})})),L=n.p+"static/media/icon.b8f19d44.svg",I=(n(49),Object(m.a)((function(){var e=Object(a.useRef)(null);Object(a.useEffect)((function(){var t;null===(t=e.current)||void 0===t||t.focus()}),[]);var t=Object(a.useCallback)((function(e){P.setQuery(e.target.value)}),[]);return Object(r.jsxs)("div",{className:"SearchBar",children:[Object(r.jsx)(i.b,{to:"/install",children:Object(r.jsx)("img",{className:"icon",src:L,alt:"icon"})}),Object(r.jsx)("input",{ref:e,type:"text",value:P.query,onChange:t,placeholder:"Search here..."}),Object(r.jsx)("button",{className:"Radicals",children:"\u5b57"})]})}))),C=Object(m.a)((function(){return Object(r.jsxs)("div",{className:"Home",children:[Object(r.jsx)(I,{}),Object(r.jsx)(R,{results:P.results})]})})),B=function(){return Object(a.useEffect)((function(){}),[]),Object(r.jsx)(i.a,{basename:"/kamatama",children:Object(r.jsxs)(o.c,{children:[Object(r.jsx)(o.a,{path:"/install",children:Object(r.jsx)(p,{})}),Object(r.jsx)(o.a,{path:"/",children:Object(r.jsx)(C,{})})]})})},F=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,52)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};s.a.render(Object(r.jsx)(a.StrictMode,{children:Object(r.jsx)(B,{})}),document.getElementById("root")),F()}},[[50,1,2]]]);
//# sourceMappingURL=main.46ddee06.chunk.js.map